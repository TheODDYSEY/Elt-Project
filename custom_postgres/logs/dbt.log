

============================== 2024-05-07 17:07:36.616136 | 364904e9-8c70-4b8b-a768-7d2c90ad3637 ==============================
[0m17:07:36.616136 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:07:36.620569 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:07:36.622551 [debug] [MainThread]: Tracking: tracking
[0m17:07:36.638994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40fed0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40fed7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40fed390>]}
[0m17:07:36.657258 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:07:36.666358 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:07:36.668147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40fed7e0>]}
[0m17:07:37.873751 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m17:07:37.899050 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m17:07:37.907843 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m17:07:37.916938 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m17:07:37.929236 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m17:07:37.936240 [debug] [MainThread]: 1699: static parser successfully parsed example/specific_movie.sql
[0m17:07:38.232231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3e7b6800>]}
[0m17:07:38.260058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3f68bfa0>]}
[0m17:07:38.261569 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:07:38.262946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3f70d4b0>]}
[0m17:07:38.266419 [info ] [MainThread]: 
[0m17:07:38.270098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:38.273704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m17:07:38.293683 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m17:07:38.295627 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:07:38.297320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:38.341098 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:07:38.343125 [debug] [ThreadPool]: On list_destination_db: Close
[0m17:07:38.346015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m17:07:38.354698 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:07:38.356114 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m17:07:38.357089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:38.376726 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:07:38.377926 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:07:38.378781 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:07:38.391773 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:07:38.394659 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m17:07:38.397979 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m17:07:38.414403 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:38.416614 [debug] [MainThread]: On master: BEGIN
[0m17:07:38.418733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:38.462206 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:07:38.464796 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:38.467365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:38.494410 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:07:38.500836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3e7db910>]}
[0m17:07:38.504175 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:38.510702 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:38.512898 [debug] [MainThread]: On master: BEGIN
[0m17:07:38.523776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:07:38.526810 [debug] [MainThread]: On master: COMMIT
[0m17:07:38.530030 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:38.533108 [debug] [MainThread]: On master: COMMIT
[0m17:07:38.584000 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:07:38.589702 [debug] [MainThread]: On master: Close
[0m17:07:38.618667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:38.621484 [info ] [MainThread]: 
[0m17:07:38.670939 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m17:07:38.673127 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m17:07:38.676758 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m17:07:38.678895 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m17:07:38.691906 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m17:07:38.738227 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-07 17:07:38.680798 => 2024-05-07 17:07:38.738017
[0m17:07:38.740773 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m17:07:38.869288 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m17:07:38.934522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:38.938215 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m17:07:38.941540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:39.006728 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:07:39.011381 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:39.015403 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m17:07:39.034720 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m17:07:39.062926 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:39.066892 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m17:07:39.077553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.092806 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:39.096328 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m17:07:39.106520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.198248 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m17:07:39.201571 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:39.204634 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m17:07:39.218995 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:07:39.243988 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:07:39.247484 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m17:07:39.264259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:07:39.271525 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-07 17:07:38.743122 => 2024-05-07 17:07:39.271317
[0m17:07:39.274950 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m17:07:39.280260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3e8594b0>]}
[0m17:07:39.285685 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.60s]
[0m17:07:39.297139 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m17:07:39.301180 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m17:07:39.304699 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m17:07:39.309561 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m17:07:39.312521 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m17:07:39.323773 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m17:07:39.360078 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-07 17:07:39.315038 => 2024-05-07 17:07:39.359816
[0m17:07:39.363569 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m17:07:39.381796 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m17:07:39.418155 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.421304 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m17:07:39.424240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:39.495187 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:07:39.498754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.501757 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m17:07:39.512686 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m17:07:39.532934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.536359 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m17:07:39.545027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.562043 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.566156 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m17:07:39.574595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.585081 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m17:07:39.588624 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.590904 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m17:07:39.610873 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:07:39.624409 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:07:39.627990 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m17:07:39.639319 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:07:39.645514 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-07 17:07:39.366701 => 2024-05-07 17:07:39.645114
[0m17:07:39.648382 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m17:07:39.658356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3e6d8f40>]}
[0m17:07:39.661658 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.35s]
[0m17:07:39.665902 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m17:07:39.668819 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m17:07:39.672520 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m17:07:39.677136 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m17:07:39.680648 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m17:07:39.694088 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m17:07:39.725431 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-07 17:07:39.685629 => 2024-05-07 17:07:39.725116
[0m17:07:39.727845 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m17:07:39.748864 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m17:07:39.779044 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.780700 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m17:07:39.789739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:39.844666 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:07:39.848376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.850737 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m17:07:39.872532 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m17:07:39.884443 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.888471 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m17:07:39.896551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.909789 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.913083 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m17:07:39.918725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:39.927543 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m17:07:39.929639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.931738 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m17:07:39.961765 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:07:39.976341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:07:39.978379 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m17:07:39.993400 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:07:40.018739 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-07 17:07:39.729619 => 2024-05-07 17:07:40.018578
[0m17:07:40.033984 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m17:07:40.058463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3e6d8f40>]}
[0m17:07:40.066302 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.38s]
[0m17:07:40.070128 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m17:07:40.072362 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m17:07:40.074353 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m17:07:40.078661 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m17:07:40.080706 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m17:07:40.089609 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m17:07:40.108996 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-07 17:07:40.082379 => 2024-05-07 17:07:40.108760
[0m17:07:40.110647 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m17:07:40.128846 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m17:07:40.144910 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.146524 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m17:07:40.148109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:40.193366 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:07:40.202997 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.211311 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m17:07:40.225564 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m17:07:40.313173 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.319270 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m17:07:40.329126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:40.337828 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.339045 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m17:07:40.342976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:40.348591 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m17:07:40.350481 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.352407 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m17:07:40.359043 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:07:40.367079 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:07:40.368877 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m17:07:40.377105 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:07:40.381221 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-07 17:07:40.111953 => 2024-05-07 17:07:40.381105
[0m17:07:40.383251 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m17:07:40.387099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3f6c8190>]}
[0m17:07:40.390779 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.31s]
[0m17:07:40.393473 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m17:07:40.396028 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m17:07:40.399267 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m17:07:40.406229 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m17:07:40.408274 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m17:07:40.413866 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m17:07:40.431524 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-05-07 17:07:40.409884 => 2024-05-07 17:07:40.431285
[0m17:07:40.433733 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m17:07:40.451173 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m17:07:40.470652 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.472529 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m17:07:40.474377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:40.518757 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:07:40.521964 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.524237 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m17:07:40.539509 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0 seconds
[0m17:07:40.547314 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.551511 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m17:07:40.557650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:40.564819 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.568801 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m17:07:40.576654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:07:40.582165 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m17:07:40.586719 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.589349 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m17:07:40.596750 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:07:40.605542 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:07:40.607325 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m17:07:40.615566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:07:40.621452 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-05-07 17:07:40.438056 => 2024-05-07 17:07:40.621282
[0m17:07:40.623512 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m17:07:40.627381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '364904e9-8c70-4b8b-a768-7d2c90ad3637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3f6c8dc0>]}
[0m17:07:40.629968 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 2[0m in 0.22s]
[0m17:07:40.633273 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m17:07:40.639594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:40.641397 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:40.642928 [debug] [MainThread]: On master: BEGIN
[0m17:07:40.644178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:40.679910 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:07:40.681879 [debug] [MainThread]: On master: COMMIT
[0m17:07:40.684062 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:40.686765 [debug] [MainThread]: On master: COMMIT
[0m17:07:40.692006 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:07:40.693756 [debug] [MainThread]: On master: Close
[0m17:07:40.696575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:40.698521 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m17:07:40.701767 [info ] [MainThread]: 
[0m17:07:40.704754 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m17:07:40.707941 [debug] [MainThread]: Command end result
[0m17:07:40.754662 [info ] [MainThread]: 
[0m17:07:40.757262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:40.759847 [info ] [MainThread]: 
[0m17:07:40.762199 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:07:40.764974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40ff0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40ff1fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a40ff21a0>]}
[0m17:07:40.767918 [debug] [MainThread]: Flushing usage events


============================== 2024-05-07 17:10:22.846089 | e5147c91-2803-4493-a0b4-4bf32ec8d852 ==============================
[0m17:10:22.846089 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:10:22.849150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:10:22.850309 [debug] [MainThread]: Tracking: tracking
[0m17:10:22.853205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8eaf5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8eaf57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8eaf53c0>]}
[0m17:10:22.875601 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:10:23.074972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:23.076700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:23.086591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d2350c0>]}
[0m17:10:23.127570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d36e680>]}
[0m17:10:23.130030 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:10:23.132070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d36e6e0>]}
[0m17:10:23.137893 [info ] [MainThread]: 
[0m17:10:23.145108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:23.150377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m17:10:23.183449 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m17:10:23.186214 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:10:23.188900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:23.233082 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:10:23.235775 [debug] [ThreadPool]: On list_destination_db: Close
[0m17:10:23.239397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m17:10:23.248155 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:10:23.249349 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m17:10:23.250270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:23.269735 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:10:23.270914 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:10:23.271816 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:10:23.276970 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:10:23.279421 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m17:10:23.281667 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m17:10:23.290949 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:23.292953 [debug] [MainThread]: On master: BEGIN
[0m17:10:23.294601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:23.315467 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:23.316742 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:23.317730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:23.325628 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:10:23.328457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d2712a0>]}
[0m17:10:23.330705 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:23.335006 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:23.336717 [debug] [MainThread]: On master: BEGIN
[0m17:10:23.342153 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:23.343667 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.344806 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:23.345812 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.348810 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:23.350061 [debug] [MainThread]: On master: Close
[0m17:10:23.352537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:23.353872 [info ] [MainThread]: 
[0m17:10:23.377265 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m17:10:23.379196 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m17:10:23.381541 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m17:10:23.383251 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m17:10:23.388737 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m17:10:23.402510 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-07 17:10:23.384672 => 2024-05-07 17:10:23.402348
[0m17:10:23.403695 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m17:10:23.467755 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m17:10:23.486611 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.488108 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m17:10:23.489482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.510470 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:10:23.511665 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.512747 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m17:10:23.517225 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m17:10:23.525707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.527308 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m17:10:23.530942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:23.535910 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.537085 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m17:10:23.540425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:23.582421 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m17:10:23.583993 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.586089 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m17:10:23.595986 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:10:23.607610 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:10:23.609256 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m17:10:23.616419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:10:23.619446 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-07 17:10:23.404580 => 2024-05-07 17:10:23.619370
[0m17:10:23.621130 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m17:10:23.623215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d0f0e20>]}
[0m17:10:23.625004 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 60[0m in 0.24s]
[0m17:10:23.628757 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m17:10:23.630475 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m17:10:23.632071 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m17:10:23.634367 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m17:10:23.635898 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m17:10:23.640976 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m17:10:23.651772 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-07 17:10:23.637307 => 2024-05-07 17:10:23.651578
[0m17:10:23.653165 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m17:10:23.659664 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m17:10:23.672997 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.673868 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m17:10:23.674699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.696027 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:10:23.697376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.698427 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m17:10:23.703051 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m17:10:23.707698 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.709067 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m17:10:23.713156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:23.719723 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.721479 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m17:10:23.725612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:23.729888 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m17:10:23.731479 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.732918 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m17:10:23.742418 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:10:23.748414 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:10:23.749906 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m17:10:23.757131 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:10:23.760384 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-07 17:10:23.654141 => 2024-05-07 17:10:23.760311
[0m17:10:23.761669 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m17:10:23.763993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d1604c0>]}
[0m17:10:23.766339 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 60[0m in 0.13s]
[0m17:10:23.770070 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m17:10:23.772480 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m17:10:23.774822 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m17:10:23.777413 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m17:10:23.779544 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m17:10:23.787281 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m17:10:23.802948 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-07 17:10:23.781049 => 2024-05-07 17:10:23.802769
[0m17:10:23.804672 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m17:10:23.812618 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m17:10:23.839123 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:23.842717 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m17:10:23.846176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.911992 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:10:23.915603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:23.920094 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m17:10:23.950533 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m17:10:23.966440 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:23.970921 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m17:10:23.981845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:23.997488 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:24.002142 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m17:10:24.013440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:24.025055 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m17:10:24.028785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:24.032289 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m17:10:24.048776 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:10:24.060172 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m17:10:24.064261 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m17:10:24.080443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:10:24.088272 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-07 17:10:23.806141 => 2024-05-07 17:10:24.088087
[0m17:10:24.091966 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m17:10:24.098101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d160100>]}
[0m17:10:24.102484 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 60[0m in 0.32s]
[0m17:10:24.107135 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m17:10:24.111301 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m17:10:24.115503 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m17:10:24.121564 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m17:10:24.125559 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m17:10:24.139081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m17:10:24.177263 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-07 17:10:24.129171 => 2024-05-07 17:10:24.176964
[0m17:10:24.180689 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m17:10:24.198251 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m17:10:24.234320 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.237364 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m17:10:24.240475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:24.294827 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:10:24.298135 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.300576 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m17:10:24.311178 [debug] [Thread-1 (]: SQL status: SELECT 60 in 0 seconds
[0m17:10:24.323279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.326603 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m17:10:24.335574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:24.345975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.349252 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m17:10:24.357930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:24.367764 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m17:10:24.371076 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.374164 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m17:10:24.385472 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:10:24.400147 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:10:24.403059 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m17:10:24.416485 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:10:24.422171 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-07 17:10:24.183807 => 2024-05-07 17:10:24.422028
[0m17:10:24.425219 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m17:10:24.429951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad86f00c10>]}
[0m17:10:24.433420 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 60[0m in 0.31s]
[0m17:10:24.437985 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m17:10:24.441683 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m17:10:24.445065 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m17:10:24.449253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m17:10:24.452391 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m17:10:24.459462 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m17:10:24.491749 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-05-07 17:10:24.455144 => 2024-05-07 17:10:24.491497
[0m17:10:24.494742 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m17:10:24.509439 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m17:10:24.541994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.544935 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m17:10:24.547580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:24.600635 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:10:24.603578 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.606619 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m17:10:24.618616 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0 seconds
[0m17:10:24.630332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.633638 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m17:10:24.642861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:24.653724 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.656650 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m17:10:24.664351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m17:10:24.675159 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m17:10:24.678272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.681018 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m17:10:24.692808 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m17:10:24.704701 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m17:10:24.707634 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m17:10:24.719392 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m17:10:24.725936 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-05-07 17:10:24.497349 => 2024-05-07 17:10:24.725773
[0m17:10:24.729128 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m17:10:24.733715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5147c91-2803-4493-a0b4-4bf32ec8d852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad86f00580>]}
[0m17:10:24.737656 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 3[0m in 0.29s]
[0m17:10:24.741738 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m17:10:24.748796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:24.751915 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:24.754830 [debug] [MainThread]: On master: BEGIN
[0m17:10:24.757580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:24.813595 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:24.817180 [debug] [MainThread]: On master: COMMIT
[0m17:10:24.820407 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:24.823641 [debug] [MainThread]: On master: COMMIT
[0m17:10:24.831627 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:24.835004 [debug] [MainThread]: On master: Close
[0m17:10:24.839879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:24.842757 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m17:10:24.846033 [info ] [MainThread]: 
[0m17:10:24.849558 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m17:10:24.856147 [debug] [MainThread]: Command end result
[0m17:10:24.915544 [info ] [MainThread]: 
[0m17:10:24.921453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:24.924873 [info ] [MainThread]: 
[0m17:10:24.929922 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:10:24.933963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d115fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d158130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad8d0f0070>]}
[0m17:10:24.937281 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 21:15:55.740320 | 6e4de5f4-f3f5-471b-87e6-4316d440038f ==============================
[0m21:15:55.740320 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:15:55.748267 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:15:55.750211 [debug] [MainThread]: Tracking: tracking
[0m21:15:55.774016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0059dd360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0059dd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0059dd3c0>]}
[0m21:15:55.845377 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:15:56.502537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:56.505100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:56.538486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa004129150>]}
[0m21:15:56.601453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0040e6710>]}
[0m21:15:56.603343 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:15:56.605489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0040e6770>]}
[0m21:15:56.611147 [info ] [MainThread]: 
[0m21:15:56.617360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:56.622275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m21:15:56.674372 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m21:15:56.676624 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m21:15:56.678554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:56.987839 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:15:56.994853 [debug] [ThreadPool]: On list_destination_db: Close
[0m21:15:57.045983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m21:15:57.130542 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:15:57.135049 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m21:15:57.138358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:57.239611 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:15:57.240903 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:15:57.242174 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:15:57.273768 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m21:15:57.281043 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m21:15:57.292348 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m21:15:57.320465 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:57.322381 [debug] [MainThread]: On master: BEGIN
[0m21:15:57.323795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:57.422129 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:15:57.423735 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:57.425454 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:57.473657 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m21:15:57.481333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003f65240>]}
[0m21:15:57.484006 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:57.531531 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:57.535277 [debug] [MainThread]: On master: BEGIN
[0m21:15:57.548513 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:15:57.550355 [debug] [MainThread]: On master: COMMIT
[0m21:15:57.552197 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:57.554864 [debug] [MainThread]: On master: COMMIT
[0m21:15:57.584700 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:15:57.588374 [debug] [MainThread]: On master: Close
[0m21:15:57.592950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:57.599474 [info ] [MainThread]: 
[0m21:15:57.657894 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m21:15:57.659680 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m21:15:57.662254 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m21:15:57.664113 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m21:15:57.682076 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m21:15:57.697728 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 21:15:57.669962 => 2024-05-21 21:15:57.697554
[0m21:15:57.700546 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m21:15:57.792055 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m21:15:57.830896 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:57.833649 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m21:15:57.835077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:57.894467 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:15:57.896204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:57.897655 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m21:15:57.917122 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0 seconds
[0m21:15:57.948101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:57.951573 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m21:15:57.957118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:57.965472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:57.967081 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m21:15:57.974523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.127171 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:15:58.133251 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:58.136553 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:15:58.147754 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:15:58.169983 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:15:58.171592 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m21:15:58.181431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:15:58.187237 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 21:15:57.701925 => 2024-05-21 21:15:58.187022
[0m21:15:58.189564 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m21:15:58.192888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003fec7c0>]}
[0m21:15:58.196495 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 80[0m in 0.53s]
[0m21:15:58.209284 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m21:15:58.212969 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m21:15:58.216476 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m21:15:58.225955 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m21:15:58.228907 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m21:15:58.247559 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m21:15:58.291553 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 21:15:58.232418 => 2024-05-21 21:15:58.291257
[0m21:15:58.296934 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m21:15:58.334396 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m21:15:58.365950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.371889 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m21:15:58.374808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:58.456131 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:15:58.458253 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.460092 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m21:15:58.468002 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0 seconds
[0m21:15:58.479235 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.482299 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m21:15:58.489219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.499055 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.502755 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m21:15:58.508312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.516464 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:15:58.518845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.521188 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:15:58.529748 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:15:58.535969 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:15:58.537644 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m21:15:58.546128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:15:58.551484 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 21:15:58.302848 => 2024-05-21 21:15:58.551377
[0m21:15:58.553053 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m21:15:58.555880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00402a770>]}
[0m21:15:58.558326 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 80[0m in 0.33s]
[0m21:15:58.562540 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m21:15:58.566783 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m21:15:58.569019 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m21:15:58.572275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m21:15:58.575849 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m21:15:58.585019 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m21:15:58.598542 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 21:15:58.577391 => 2024-05-21 21:15:58.598221
[0m21:15:58.600491 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m21:15:58.612887 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m21:15:58.627550 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.629242 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m21:15:58.631173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:58.670080 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:15:58.671246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.672266 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m21:15:58.687254 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0 seconds
[0m21:15:58.693381 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.694984 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m21:15:58.699281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.703984 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.705204 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m21:15:58.707811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.713778 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:15:58.715090 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.715980 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:15:58.721306 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:15:58.727367 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:15:58.728768 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m21:15:58.735637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:15:58.738201 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 21:15:58.602060 => 2024-05-21 21:15:58.738126
[0m21:15:58.739183 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m21:15:58.740933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa00402b2e0>]}
[0m21:15:58.742217 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 80[0m in 0.17s]
[0m21:15:58.744262 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m21:15:58.746491 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m21:15:58.748717 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m21:15:58.751579 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m21:15:58.752866 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m21:15:58.757263 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m21:15:58.769741 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 21:15:58.753744 => 2024-05-21 21:15:58.769561
[0m21:15:58.771120 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m21:15:58.780797 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m21:15:58.792136 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.793548 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m21:15:58.794663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:58.826436 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:15:58.827887 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.829402 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m21:15:58.837447 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0 seconds
[0m21:15:58.844694 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.846285 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m21:15:58.851037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.861099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.862915 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m21:15:58.867847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:58.873044 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:15:58.874334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.875526 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:15:58.886200 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:15:58.891707 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:15:58.893144 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m21:15:58.905426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:15:58.909147 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 21:15:58.772237 => 2024-05-21 21:15:58.909037
[0m21:15:58.911116 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m21:15:58.915832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa001e4fbe0>]}
[0m21:15:58.917818 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 80[0m in 0.16s]
[0m21:15:58.919721 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m21:15:58.921376 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m21:15:58.922822 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m21:15:58.925084 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m21:15:58.926761 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m21:15:58.932057 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m21:15:58.944364 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-05-21 21:15:58.928235 => 2024-05-21 21:15:58.944212
[0m21:15:58.945929 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m21:15:58.954578 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m21:15:58.969711 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:58.970992 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m21:15:58.972152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:59.004288 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:15:59.005406 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:59.006276 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m21:15:59.012309 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0 seconds
[0m21:15:59.018275 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:59.019597 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m21:15:59.022743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:59.033127 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:59.035100 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m21:15:59.038400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:15:59.043108 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m21:15:59.045047 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:59.047232 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m21:15:59.052651 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:15:59.057687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:15:59.060409 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m21:15:59.067923 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:15:59.071281 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-05-21 21:15:58.947755 => 2024-05-21 21:15:59.071181
[0m21:15:59.072568 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m21:15:59.074684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4de5f4-f3f5-471b-87e6-4316d440038f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa001e4fbe0>]}
[0m21:15:59.076677 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 4[0m in 0.15s]
[0m21:15:59.080727 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m21:15:59.087116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:59.088314 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:59.089364 [debug] [MainThread]: On master: BEGIN
[0m21:15:59.090630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:59.122856 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:15:59.124311 [debug] [MainThread]: On master: COMMIT
[0m21:15:59.125600 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:59.127070 [debug] [MainThread]: On master: COMMIT
[0m21:15:59.132628 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:15:59.134704 [debug] [MainThread]: On master: Close
[0m21:15:59.137224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:59.138752 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m21:15:59.142143 [info ] [MainThread]: 
[0m21:15:59.145333 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m21:15:59.150177 [debug] [MainThread]: Command end result
[0m21:15:59.184815 [info ] [MainThread]: 
[0m21:15:59.188235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:15:59.190510 [info ] [MainThread]: 
[0m21:15:59.193167 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:15:59.198512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003f920b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003fef370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa003fef280>]}
[0m21:15:59.201142 [debug] [MainThread]: Flushing usage events


============================== 2024-05-21 21:18:03.503529 | 66ecee5e-abc7-4b1b-a617-bcbc7194fc8b ==============================
[0m21:18:03.503529 [info ] [MainThread]: Running with dbt=1.4.7
[0m21:18:03.506900 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:18:03.508233 [debug] [MainThread]: Tracking: tracking
[0m21:18:03.510824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162f549360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162f5497e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162f5493c0>]}
[0m21:18:03.534069 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m21:18:03.720259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:03.721600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:03.733691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162dc950c0>]}
[0m21:18:03.761268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162dbda680>]}
[0m21:18:03.762796 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:18:03.764075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162dbda6e0>]}
[0m21:18:03.767232 [info ] [MainThread]: 
[0m21:18:03.771448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:18:03.774220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m21:18:03.790887 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m21:18:03.792774 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m21:18:03.794315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:03.849493 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m21:18:03.853939 [debug] [ThreadPool]: On list_destination_db: Close
[0m21:18:03.858009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m21:18:03.866654 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:18:03.868622 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m21:18:03.870254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:03.891823 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:18:03.892814 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m21:18:03.893571 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:18:03.897901 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m21:18:03.900188 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m21:18:03.903032 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m21:18:03.913634 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.915249 [debug] [MainThread]: On master: BEGIN
[0m21:18:03.916643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:03.939873 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:18:03.941520 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.943117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:18:03.952513 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m21:18:03.955343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162dad11b0>]}
[0m21:18:03.956823 [debug] [MainThread]: On master: ROLLBACK
[0m21:18:03.960727 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.962318 [debug] [MainThread]: On master: BEGIN
[0m21:18:03.968217 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:18:03.969570 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.970709 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:03.971870 [debug] [MainThread]: On master: COMMIT
[0m21:18:03.975546 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:18:03.977073 [debug] [MainThread]: On master: Close
[0m21:18:03.979217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:03.983588 [info ] [MainThread]: 
[0m21:18:04.017529 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m21:18:04.020094 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m21:18:04.023079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m21:18:04.025473 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m21:18:04.033984 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m21:18:04.055376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-21 21:18:04.028123 => 2024-05-21 21:18:04.055197
[0m21:18:04.057612 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m21:18:04.159182 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m21:18:04.186224 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.188590 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m21:18:04.190767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:04.234208 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:18:04.236581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.238868 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m21:18:04.245728 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m21:18:04.259201 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.261514 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m21:18:04.267469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:04.276195 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.278315 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m21:18:04.283855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:04.355295 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:18:04.358439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.361849 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m21:18:04.373407 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:18:04.393866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m21:18:04.397694 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m21:18:04.414383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:18:04.423001 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-21 21:18:04.060131 => 2024-05-21 21:18:04.422672
[0m21:18:04.427297 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m21:18:04.433526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162db4cf10>]}
[0m21:18:04.439840 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 100[0m in 0.41s]
[0m21:18:04.452056 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m21:18:04.456857 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m21:18:04.461608 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m21:18:04.468587 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m21:18:04.472981 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m21:18:04.488182 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m21:18:04.531233 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-21 21:18:04.476684 => 2024-05-21 21:18:04.530753
[0m21:18:04.535246 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m21:18:04.559327 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m21:18:04.604626 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.608713 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m21:18:04.612932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:04.686078 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:18:04.689567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.693295 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m21:18:04.705952 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m21:18:04.721266 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.725123 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m21:18:04.734590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:04.749127 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.752732 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m21:18:04.762925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:04.777696 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:18:04.781451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.785124 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m21:18:04.797810 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:18:04.808575 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m21:18:04.812455 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m21:18:04.827610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:18:04.835348 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-21 21:18:04.538855 => 2024-05-21 21:18:04.835170
[0m21:18:04.838863 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m21:18:04.844665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162db966e0>]}
[0m21:18:04.856469 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 100[0m in 0.38s]
[0m21:18:04.860547 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m21:18:04.864996 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m21:18:04.869054 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m21:18:04.874129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m21:18:04.877297 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m21:18:04.892022 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m21:18:04.931971 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-21 21:18:04.880987 => 2024-05-21 21:18:04.931666
[0m21:18:04.935572 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m21:18:04.955706 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m21:18:04.992906 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:04.996412 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m21:18:04.999527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:05.065467 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:18:05.068685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:05.071883 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m21:18:05.110640 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m21:18:05.125767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:05.130332 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m21:18:05.141365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.156288 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:05.159494 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m21:18:05.168599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.178562 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:18:05.181714 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:05.185459 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m21:18:05.198388 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:18:05.208850 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m21:18:05.212142 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m21:18:05.227909 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:18:05.235260 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-21 21:18:04.938937 => 2024-05-21 21:18:05.235030
[0m21:18:05.238667 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m21:18:05.243910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162db954e0>]}
[0m21:18:05.247867 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 100[0m in 0.37s]
[0m21:18:05.254138 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m21:18:05.258170 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m21:18:05.261743 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m21:18:05.269238 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m21:18:05.272931 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m21:18:05.285059 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m21:18:05.338360 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-21 21:18:05.275928 => 2024-05-21 21:18:05.337896
[0m21:18:05.345762 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m21:18:05.383286 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m21:18:05.427158 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.431641 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m21:18:05.436304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:05.496067 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:18:05.497702 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.499064 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m21:18:05.505910 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m21:18:05.512711 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.513964 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m21:18:05.519101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.528499 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.529737 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m21:18:05.534867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.540508 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:18:05.541718 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.542959 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m21:18:05.549215 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:18:05.555651 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m21:18:05.557196 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m21:18:05.564918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:18:05.568929 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-21 21:18:05.356409 => 2024-05-21 21:18:05.568775
[0m21:18:05.570515 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m21:18:05.573199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162c1bbb80>]}
[0m21:18:05.575222 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 100[0m in 0.31s]
[0m21:18:05.577264 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m21:18:05.579541 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m21:18:05.581401 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m21:18:05.584625 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m21:18:05.586623 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m21:18:05.591249 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m21:18:05.606527 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-05-21 21:18:05.588474 => 2024-05-21 21:18:05.606353
[0m21:18:05.608447 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m21:18:05.617385 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m21:18:05.638500 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.640957 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m21:18:05.642945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:05.685424 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:18:05.689199 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.692551 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m21:18:05.706118 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0 seconds
[0m21:18:05.720955 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.724273 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m21:18:05.733885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.746376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.751139 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m21:18:05.760704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:18:05.771926 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m21:18:05.775972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.779227 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m21:18:05.791851 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:18:05.802845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m21:18:05.806289 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m21:18:05.820139 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m21:18:05.826979 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-05-21 21:18:05.609997 => 2024-05-21 21:18:05.826822
[0m21:18:05.830254 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m21:18:05.836462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ecee5e-abc7-4b1b-a617-bcbc7194fc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162c1bbb80>]}
[0m21:18:05.840913 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 5[0m in 0.25s]
[0m21:18:05.844783 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m21:18:05.853297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:18:05.856796 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:05.860310 [debug] [MainThread]: On master: BEGIN
[0m21:18:05.863517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:05.928849 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:18:05.932318 [debug] [MainThread]: On master: COMMIT
[0m21:18:05.935644 [debug] [MainThread]: Using postgres connection "master"
[0m21:18:05.939178 [debug] [MainThread]: On master: COMMIT
[0m21:18:05.948261 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:18:05.952074 [debug] [MainThread]: On master: Close
[0m21:18:05.957079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:05.960213 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m21:18:05.964884 [info ] [MainThread]: 
[0m21:18:05.969892 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m21:18:05.975287 [debug] [MainThread]: Command end result
[0m21:18:06.042382 [info ] [MainThread]: 
[0m21:18:06.046018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:06.049829 [info ] [MainThread]: 
[0m21:18:06.057074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:18:06.061514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162db75ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162dc4ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162db4fca0>]}
[0m21:18:06.065155 [debug] [MainThread]: Flushing usage events


============================== 2024-06-04 06:54:23.094699 | 60564373-174e-4980-8014-756a75ddb2f6 ==============================
[0m06:54:23.094699 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:54:23.097443 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:54:23.098254 [debug] [MainThread]: Tracking: tracking
[0m06:54:23.108348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d6531360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d65317e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d65313c0>]}
[0m06:54:23.123411 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:54:23.363895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:23.364712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:23.372664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4c85120>]}
[0m06:54:23.391914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4bc26e0>]}
[0m06:54:23.392946 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:54:23.394044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4bc2740>]}
[0m06:54:23.396589 [info ] [MainThread]: 
[0m06:54:23.399420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:54:23.401596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:54:23.414164 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:54:23.415078 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:54:23.415969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:23.451888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:54:23.453920 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:54:23.456552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:54:23.463007 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:54:23.463755 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:54:23.464304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:23.479844 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:54:23.480735 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:54:23.481416 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:54:23.490004 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m06:54:23.491785 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:54:23.493535 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:54:23.501314 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:23.502113 [debug] [MainThread]: On master: BEGIN
[0m06:54:23.502854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:54:23.516865 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:23.517704 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:23.518350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:54:23.525965 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:54:23.527567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4ab9210>]}
[0m06:54:23.528380 [debug] [MainThread]: On master: ROLLBACK
[0m06:54:23.530130 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:23.530794 [debug] [MainThread]: On master: BEGIN
[0m06:54:23.533507 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:23.534366 [debug] [MainThread]: On master: COMMIT
[0m06:54:23.534972 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:23.535506 [debug] [MainThread]: On master: COMMIT
[0m06:54:23.537106 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:54:23.537796 [debug] [MainThread]: On master: Close
[0m06:54:23.538763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:23.539633 [info ] [MainThread]: 
[0m06:54:23.555313 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:54:23.556278 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m06:54:23.557432 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:54:23.558298 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:54:23.561467 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:54:23.568198 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-06-04 06:54:23.558844 => 2024-06-04 06:54:23.568076
[0m06:54:23.569174 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:54:23.616260 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:54:23.626135 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.626912 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:54:23.627602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:23.643403 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:23.644356 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.644984 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:54:23.649202 [debug] [Thread-1 (]: SQL status: SELECT 120 in 0 seconds
[0m06:54:23.655619 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.656330 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:54:23.658168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.661219 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.661859 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:54:23.663826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.686793 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:54:23.688368 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.689804 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:54:23.694594 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:23.701655 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:23.702652 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:54:23.708251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:23.710933 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-06-04 06:54:23.570497 => 2024-06-04 06:54:23.710867
[0m06:54:23.711855 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:54:23.713123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b34eb0>]}
[0m06:54:23.714060 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 120[0m in 0.16s]
[0m06:54:23.716545 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:54:23.717515 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:54:23.718346 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m06:54:23.719611 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:54:23.720581 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:54:23.724654 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:54:23.731224 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-06-04 06:54:23.721438 => 2024-06-04 06:54:23.731109
[0m06:54:23.732055 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:54:23.737213 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:54:23.745137 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.745876 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:54:23.746516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:23.761992 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:23.762801 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.763412 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:54:23.765933 [debug] [Thread-1 (]: SQL status: SELECT 120 in 0 seconds
[0m06:54:23.769078 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.769868 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:54:23.772084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.775241 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.775947 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:54:23.777932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.781403 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:54:23.782125 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.782838 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:54:23.789350 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:23.792488 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:23.793379 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:54:23.798348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:23.800673 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-06-04 06:54:23.732766 => 2024-06-04 06:54:23.800605
[0m06:54:23.801638 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:54:23.803393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b7e740>]}
[0m06:54:23.804939 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 120[0m in 0.08s]
[0m06:54:23.806677 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:54:23.808125 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m06:54:23.809108 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m06:54:23.810873 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m06:54:23.811691 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m06:54:23.815649 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m06:54:23.824248 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-06-04 06:54:23.812344 => 2024-06-04 06:54:23.824125
[0m06:54:23.825337 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m06:54:23.831102 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m06:54:23.839033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.839844 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m06:54:23.840556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:23.856994 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:23.857837 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.858426 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m06:54:23.871279 [debug] [Thread-1 (]: SQL status: SELECT 120 in 0 seconds
[0m06:54:23.874632 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.875342 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m06:54:23.877230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.880401 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.881225 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m06:54:23.883320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.885792 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:54:23.886538 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.887088 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m06:54:23.890481 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:23.893321 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m06:54:23.894033 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m06:54:23.898373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:23.900336 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-06-04 06:54:23.826544 => 2024-06-04 06:54:23.900279
[0m06:54:23.901064 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m06:54:23.902448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b7e110>]}
[0m06:54:23.903474 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 120[0m in 0.09s]
[0m06:54:23.904547 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m06:54:23.905452 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:54:23.906342 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m06:54:23.907606 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:54:23.908472 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:54:23.912357 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:54:23.919095 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-06-04 06:54:23.909231 => 2024-06-04 06:54:23.918990
[0m06:54:23.919858 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:54:23.925702 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:54:23.932320 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.933172 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:54:23.933952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:23.951730 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:23.952652 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.953379 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:54:23.956728 [debug] [Thread-1 (]: SQL status: SELECT 120 in 0 seconds
[0m06:54:23.959892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.960542 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:54:23.962677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.967135 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.967942 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:54:23.970077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:23.972778 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:54:23.973451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.974000 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:54:23.977455 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:23.980277 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:23.981106 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:54:23.985902 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:23.988065 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-06-04 06:54:23.920559 => 2024-06-04 06:54:23.988010
[0m06:54:23.988832 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:54:23.989961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d41a3a60>]}
[0m06:54:23.990848 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 120[0m in 0.08s]
[0m06:54:23.991944 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:54:23.992843 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m06:54:23.993590 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m06:54:23.994791 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m06:54:23.995629 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m06:54:23.997570 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m06:54:24.004474 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-06-04 06:54:23.996179 => 2024-06-04 06:54:24.004360
[0m06:54:24.005388 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m06:54:24.010687 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m06:54:24.019020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.020049 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m06:54:24.021180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:24.039278 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:24.040817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.041584 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m06:54:24.046048 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0 seconds
[0m06:54:24.049462 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.050276 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m06:54:24.052450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:24.056175 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.056940 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m06:54:24.059100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:24.061680 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:54:24.062436 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.063066 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m06:54:24.066973 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:24.070040 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m06:54:24.070855 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m06:54:24.074727 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:24.076689 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-06-04 06:54:24.006071 => 2024-06-04 06:54:24.076631
[0m06:54:24.077458 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m06:54:24.078713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60564373-174e-4980-8014-756a75ddb2f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d41a3a60>]}
[0m06:54:24.079695 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 6[0m in 0.08s]
[0m06:54:24.080779 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m06:54:24.083168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:54:24.083947 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:24.084486 [debug] [MainThread]: On master: BEGIN
[0m06:54:24.085060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:54:24.099218 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:24.100089 [debug] [MainThread]: On master: COMMIT
[0m06:54:24.100683 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:24.101300 [debug] [MainThread]: On master: COMMIT
[0m06:54:24.103018 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:54:24.103708 [debug] [MainThread]: On master: Close
[0m06:54:24.104748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:24.105464 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m06:54:24.106219 [info ] [MainThread]: 
[0m06:54:24.107215 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m06:54:24.108396 [debug] [MainThread]: Command end result
[0m06:54:24.121767 [info ] [MainThread]: 
[0m06:54:24.123023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:24.124353 [info ] [MainThread]: 
[0m06:54:24.125687 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:54:24.126985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b61f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b37a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d4b37940>]}
[0m06:54:24.128129 [debug] [MainThread]: Flushing usage events


============================== 2024-08-21 12:57:11.186388 | 331e39ad-f873-48d7-accb-e0d015c312c8 ==============================
[0m12:57:11.186388 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:57:11.189577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:11.191030 [debug] [MainThread]: Tracking: tracking
[0m12:57:11.203903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ab29d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ab29d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ab29d3c0>]}
[0m12:57:11.225603 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:57:11.591979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:11.593141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:11.603007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a99dd180>]}
[0m12:57:11.628770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a9b12740>]}
[0m12:57:11.629966 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:57:11.631630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a9b127a0>]}
[0m12:57:11.635426 [info ] [MainThread]: 
[0m12:57:11.639173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:11.641926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:57:11.656503 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:57:11.657820 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:57:11.658950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:11.710449 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:57:11.712391 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:57:11.715256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:57:11.723186 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:57:11.724312 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:57:11.725224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:11.750656 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:11.752787 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:57:11.754049 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:57:11.760640 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m12:57:11.763006 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:57:11.766747 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:57:11.776348 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.777797 [debug] [MainThread]: On master: BEGIN
[0m12:57:11.779055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:11.803634 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:11.804995 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.806475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:11.813790 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:57:11.817366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a9a15270>]}
[0m12:57:11.819441 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:11.823162 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.824418 [debug] [MainThread]: On master: BEGIN
[0m12:57:11.828751 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:11.830044 [debug] [MainThread]: On master: COMMIT
[0m12:57:11.831190 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:11.832627 [debug] [MainThread]: On master: COMMIT
[0m12:57:11.835986 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:11.837017 [debug] [MainThread]: On master: Close
[0m12:57:11.838253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:11.839872 [info ] [MainThread]: 
[0m12:57:11.860318 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:57:11.862243 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m12:57:11.864501 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:57:11.866129 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:57:11.872006 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:57:11.886855 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-21 12:57:11.867652 => 2024-08-21 12:57:11.886720
[0m12:57:11.887993 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:57:11.943572 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:57:11.959080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:11.960070 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:57:11.961257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:11.985590 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:11.987406 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:11.988662 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m12:57:11.992829 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:12.001543 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:12.002834 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m12:57:12.006411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.010287 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:12.011818 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m12:57:12.015372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.041927 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m12:57:12.043309 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:12.044497 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m12:57:12.050315 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:12.056652 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:12.058041 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m12:57:12.064227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:12.067354 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-21 12:57:11.889137 => 2024-08-21 12:57:12.067262
[0m12:57:12.068208 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:57:12.069543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a98991b0>]}
[0m12:57:12.070592 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.21s]
[0m12:57:12.073393 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:57:12.074390 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:57:12.075234 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m12:57:12.076500 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:57:12.077342 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:57:12.080632 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:57:12.088968 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-21 12:57:12.077951 => 2024-08-21 12:57:12.088826
[0m12:57:12.090043 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:57:12.095402 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:57:12.105830 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.106764 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:57:12.107480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:12.127676 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:12.128866 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.129894 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m12:57:12.133678 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:12.137271 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.138018 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m12:57:12.140026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.143366 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.144181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m12:57:12.146177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.151007 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m12:57:12.152037 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.152767 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m12:57:12.156406 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:12.159382 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:12.160223 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m12:57:12.164979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:12.167381 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-21 12:57:12.090836 => 2024-08-21 12:57:12.167315
[0m12:57:12.168273 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:57:12.169559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a98de260>]}
[0m12:57:12.170580 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m12:57:12.171704 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:57:12.172822 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:57:12.173659 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m12:57:12.174984 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m12:57:12.175936 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m12:57:12.180802 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m12:57:12.191199 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-21 12:57:12.176556 => 2024-08-21 12:57:12.190978
[0m12:57:12.192817 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m12:57:12.200583 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m12:57:12.210798 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:12.211859 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m12:57:12.212740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:12.232020 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:12.233159 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:12.234048 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m12:57:12.244132 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:12.247780 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:12.249246 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m12:57:12.253488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.256457 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m12:57:12.257232 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:12.257847 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m12:57:12.261403 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:12.264448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:12.265992 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m12:57:12.268891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:12.271544 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-21 12:57:12.195104 => 2024-08-21 12:57:12.271489
[0m12:57:12.272476 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m12:57:12.273869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a98de260>]}
[0m12:57:12.275787 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m12:57:12.276932 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:57:12.278319 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:57:12.279839 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m12:57:12.281426 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:57:12.282934 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:57:12.287420 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:57:12.296692 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-21 12:57:12.284428 => 2024-08-21 12:57:12.296546
[0m12:57:12.297545 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:57:12.304311 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:57:12.315626 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.317635 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:57:12.318937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:12.338626 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:12.339635 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.340372 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m12:57:12.344006 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:12.347551 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.348469 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m12:57:12.351603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.355015 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.355783 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m12:57:12.358442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.361646 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m12:57:12.363033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.364303 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m12:57:12.370607 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:12.374914 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:12.376315 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m12:57:12.383402 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:12.386278 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-21 12:57:12.298666 => 2024-08-21 12:57:12.386202
[0m12:57:12.387895 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:57:12.389720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a992e1d0>]}
[0m12:57:12.390870 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.11s]
[0m12:57:12.392281 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:57:12.393784 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m12:57:12.395024 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m12:57:12.396472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m12:57:12.397450 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m12:57:12.400584 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m12:57:12.408827 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-21 12:57:12.398331 => 2024-08-21 12:57:12.408682
[0m12:57:12.410256 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m12:57:12.415910 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m12:57:12.425667 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:12.426544 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m12:57:12.427368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:12.446375 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:12.447727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:12.450603 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m12:57:12.454386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:57:12.458193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:12.459208 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m12:57:12.461745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:12.465789 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m12:57:12.467125 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:12.468276 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m12:57:12.472939 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:12.476614 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:12.477727 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m12:57:12.482443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:12.485236 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-21 12:57:12.411123 => 2024-08-21 12:57:12.485161
[0m12:57:12.486768 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m12:57:12.489714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331e39ad-f873-48d7-accb-e0d015c312c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a992da50>]}
[0m12:57:12.491165 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.09s]
[0m12:57:12.492680 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m12:57:12.496218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:12.497711 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:12.499153 [debug] [MainThread]: On master: BEGIN
[0m12:57:12.501338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:12.521320 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:12.522336 [debug] [MainThread]: On master: COMMIT
[0m12:57:12.523109 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:12.523901 [debug] [MainThread]: On master: COMMIT
[0m12:57:12.525867 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:12.526704 [debug] [MainThread]: On master: Close
[0m12:57:12.528152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:12.528958 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m12:57:12.529735 [info ] [MainThread]: 
[0m12:57:12.530732 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m12:57:12.532792 [debug] [MainThread]: Command end result
[0m12:57:12.553181 [info ] [MainThread]: 
[0m12:57:12.555565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:12.557043 [info ] [MainThread]: 
[0m12:57:12.558489 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:57:12.560216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a998eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a9a333d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a9a33cd0>]}
[0m12:57:12.561624 [debug] [MainThread]: Flushing usage events


============================== 2024-08-21 12:57:20.753892 | c9cd3e37-e4fc-4879-a3fe-418a12324db0 ==============================
[0m12:57:20.753892 [info ] [MainThread]: Running with dbt=1.4.7
[0m12:57:20.757080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:57:20.758387 [debug] [MainThread]: Tracking: tracking
[0m12:57:20.761370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67a9d90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67a9d97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67a9d9390>]}
[0m12:57:20.785253 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m12:57:20.965631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:20.966723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:20.974295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6791291e0>]}
[0m12:57:20.999484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67906a7a0>]}
[0m12:57:21.001103 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m12:57:21.002847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67906a800>]}
[0m12:57:21.005980 [info ] [MainThread]: 
[0m12:57:21.009359 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:21.011734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m12:57:21.022952 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m12:57:21.024426 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m12:57:21.025615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:21.049993 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m12:57:21.052157 [debug] [ThreadPool]: On list_destination_db: Close
[0m12:57:21.055689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m12:57:21.064990 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:57:21.066450 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m12:57:21.067980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:21.093716 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m12:57:21.095300 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m12:57:21.096789 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:57:21.103122 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m12:57:21.106970 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m12:57:21.111049 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m12:57:21.122867 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:21.125268 [debug] [MainThread]: On master: BEGIN
[0m12:57:21.126763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:21.150563 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:21.152083 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:21.153635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:57:21.163215 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m12:57:21.165747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67915d2d0>]}
[0m12:57:21.167201 [debug] [MainThread]: On master: ROLLBACK
[0m12:57:21.171349 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:21.172573 [debug] [MainThread]: On master: BEGIN
[0m12:57:21.177953 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:21.179520 [debug] [MainThread]: On master: COMMIT
[0m12:57:21.181173 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:21.182102 [debug] [MainThread]: On master: COMMIT
[0m12:57:21.185018 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:21.186921 [debug] [MainThread]: On master: Close
[0m12:57:21.188919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:21.191251 [info ] [MainThread]: 
[0m12:57:21.216421 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m12:57:21.218271 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m12:57:21.220755 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m12:57:21.222399 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m12:57:21.227214 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m12:57:21.242983 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-21 12:57:21.223587 => 2024-08-21 12:57:21.242837
[0m12:57:21.244413 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m12:57:21.317681 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m12:57:21.340322 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.341953 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m12:57:21.344478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.393520 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:21.406961 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.408852 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m12:57:21.419107 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:21.445443 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.458318 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m12:57:21.465430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.474397 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.475729 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m12:57:21.481969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.559687 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m12:57:21.560883 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.561858 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m12:57:21.565988 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:21.575802 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m12:57:21.577188 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m12:57:21.585842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:21.594369 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-21 12:57:21.245712 => 2024-08-21 12:57:21.594247
[0m12:57:21.596036 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m12:57:21.598287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe678fdcdf0>]}
[0m12:57:21.599886 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.38s]
[0m12:57:21.607486 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m12:57:21.610081 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m12:57:21.612384 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m12:57:21.614323 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m12:57:21.615432 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m12:57:21.630174 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m12:57:21.642196 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-21 12:57:21.616428 => 2024-08-21 12:57:21.641999
[0m12:57:21.643529 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m12:57:21.661727 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m12:57:21.675420 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.676788 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m12:57:21.678640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.716557 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:21.718262 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.722364 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m12:57:21.728508 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:21.733747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.745682 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m12:57:21.750305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.758176 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.760067 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m12:57:21.763129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.769427 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m12:57:21.778874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.780208 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m12:57:21.787151 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:21.793770 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m12:57:21.795201 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m12:57:21.806430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:21.813149 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-21 12:57:21.647296 => 2024-08-21 12:57:21.813031
[0m12:57:21.815390 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m12:57:21.825701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe679026800>]}
[0m12:57:21.827401 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.21s]
[0m12:57:21.828961 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m12:57:21.830596 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m12:57:21.832158 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m12:57:21.834174 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m12:57:21.836171 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m12:57:21.849132 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m12:57:21.864899 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-21 12:57:21.837716 => 2024-08-21 12:57:21.864719
[0m12:57:21.866385 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m12:57:21.881019 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m12:57:21.891962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.893492 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m12:57:21.894772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:21.924206 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:21.925708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.927530 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m12:57:21.942013 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:21.947827 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.949063 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m12:57:21.952441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.959346 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.960499 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m12:57:21.963344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:21.967427 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m12:57:21.968962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.970504 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m12:57:21.976210 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:21.979736 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m12:57:21.980741 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m12:57:21.986138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:21.990984 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-21 12:57:21.867400 => 2024-08-21 12:57:21.990883
[0m12:57:21.992222 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m12:57:21.994283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe679027310>]}
[0m12:57:21.995723 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.16s]
[0m12:57:21.997543 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m12:57:21.999165 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m12:57:22.000723 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m12:57:22.003202 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m12:57:22.005469 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m12:57:22.011182 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m12:57:22.021327 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-21 12:57:22.006633 => 2024-08-21 12:57:22.021129
[0m12:57:22.022792 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m12:57:22.029140 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m12:57:22.038786 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.040542 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m12:57:22.041724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:22.065447 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:22.066859 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.067898 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m12:57:22.072978 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m12:57:22.079164 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.080739 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m12:57:22.084713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:22.091691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.093141 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m12:57:22.096917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:22.100329 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m12:57:22.101541 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.102967 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m12:57:22.108213 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:22.113486 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m12:57:22.114955 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m12:57:22.121661 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:22.125041 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-21 12:57:22.023803 => 2024-08-21 12:57:22.124950
[0m12:57:22.126318 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m12:57:22.128393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe678654f40>]}
[0m12:57:22.129970 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.13s]
[0m12:57:22.131738 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m12:57:22.133188 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m12:57:22.134548 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m12:57:22.136875 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m12:57:22.138877 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m12:57:22.142829 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m12:57:22.154391 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-21 12:57:22.140022 => 2024-08-21 12:57:22.154191
[0m12:57:22.155897 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m12:57:22.165369 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m12:57:22.178662 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.180086 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m12:57:22.181281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:22.204358 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m12:57:22.205695 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.206868 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m12:57:22.212502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m12:57:22.223128 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.224424 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m12:57:22.227780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:22.231609 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.232514 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m12:57:22.236529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m12:57:22.241698 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m12:57:22.243122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.244386 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m12:57:22.249069 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m12:57:22.252549 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m12:57:22.254988 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m12:57:22.261202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m12:57:22.263990 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-21 12:57:22.157211 => 2024-08-21 12:57:22.263922
[0m12:57:22.265383 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m12:57:22.267902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd3e37-e4fc-4879-a3fe-418a12324db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67864bf70>]}
[0m12:57:22.273295 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.13s]
[0m12:57:22.275579 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m12:57:22.279001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:57:22.280598 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:22.282102 [debug] [MainThread]: On master: BEGIN
[0m12:57:22.283659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:22.309955 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m12:57:22.311450 [debug] [MainThread]: On master: COMMIT
[0m12:57:22.312826 [debug] [MainThread]: Using postgres connection "master"
[0m12:57:22.314183 [debug] [MainThread]: On master: COMMIT
[0m12:57:22.317470 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m12:57:22.318863 [debug] [MainThread]: On master: Close
[0m12:57:22.321637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:22.323153 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m12:57:22.324733 [info ] [MainThread]: 
[0m12:57:22.326371 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m12:57:22.328056 [debug] [MainThread]: Command end result
[0m12:57:22.354131 [info ] [MainThread]: 
[0m12:57:22.355863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:22.359137 [info ] [MainThread]: 
[0m12:57:22.361017 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:57:22.362839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe679005ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe678fdfa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe678fdf940>]}
[0m12:57:22.364698 [debug] [MainThread]: Flushing usage events


============================== 2024-08-22 11:39:01.091579 | 06ae730a-9ec2-4354-a909-648517d354e7 ==============================
[0m11:39:01.091579 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:39:01.095189 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:39:01.096598 [debug] [MainThread]: Tracking: tracking
[0m11:39:01.113050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eab165360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eab1657e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eab1653c0>]}
[0m11:39:01.139931 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:39:01.541393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:01.543163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:01.551990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea98a51b0>]}
[0m11:39:01.585082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea99da770>]}
[0m11:39:01.586815 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:39:01.588350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea99da7d0>]}
[0m11:39:01.592829 [info ] [MainThread]: 
[0m11:39:01.596169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:01.598714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:39:01.613488 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:39:01.615214 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:39:01.616764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:01.668186 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:39:01.670517 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:39:01.675699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:39:01.683922 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:39:01.685520 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:39:01.686959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:01.718132 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:39:01.719609 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:39:01.721075 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:39:01.729461 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m11:39:01.733101 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:39:01.736906 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:39:01.747982 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:01.749494 [debug] [MainThread]: On master: BEGIN
[0m11:39:01.751039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:01.781079 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:01.782806 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:01.784284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:01.794882 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:39:01.797471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea98d92a0>]}
[0m11:39:01.798929 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:01.801766 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:01.802779 [debug] [MainThread]: On master: BEGIN
[0m11:39:01.807948 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:01.809625 [debug] [MainThread]: On master: COMMIT
[0m11:39:01.810827 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:01.811768 [debug] [MainThread]: On master: COMMIT
[0m11:39:01.814445 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:39:01.815497 [debug] [MainThread]: On master: Close
[0m11:39:01.817050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:01.818309 [info ] [MainThread]: 
[0m11:39:01.841674 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:39:01.843897 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m11:39:01.846949 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:39:01.849047 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:39:01.854081 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:39:01.869226 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-22 11:39:01.850478 => 2024-08-22 11:39:01.869062
[0m11:39:01.870776 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:39:01.925700 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:39:01.940766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:01.942294 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:39:01.943538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:01.969500 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:01.970805 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:01.971729 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:39:01.976304 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:01.985787 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:01.986956 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m11:39:01.990883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:01.996574 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:01.997653 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m11:39:02.001537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.033310 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m11:39:02.034777 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:02.035835 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m11:39:02.041840 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:02.050589 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:02.051890 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m11:39:02.060346 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:02.062679 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-22 11:39:01.872187 => 2024-08-22 11:39:02.062623
[0m11:39:02.063910 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:39:02.066050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea9768dc0>]}
[0m11:39:02.067767 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.22s]
[0m11:39:02.071081 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:39:02.073220 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:39:02.075301 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m11:39:02.077250 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:39:02.078511 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:39:02.082952 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:39:02.093975 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-22 11:39:02.079872 => 2024-08-22 11:39:02.093761
[0m11:39:02.095535 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:39:02.103359 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:39:02.116373 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.117681 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:39:02.119081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.147489 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:02.149138 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.150300 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:39:02.153917 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:02.159242 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.160427 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m11:39:02.163475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.167993 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.168886 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m11:39:02.171729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.177150 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m11:39:02.178036 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.178752 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m11:39:02.182987 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:02.186477 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:02.187665 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m11:39:02.194617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:02.197368 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-22 11:39:02.096711 => 2024-08-22 11:39:02.197289
[0m11:39:02.198594 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:39:02.200736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea97a6290>]}
[0m11:39:02.202215 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.12s]
[0m11:39:02.203861 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:39:02.206272 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:39:02.208757 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m11:39:02.211523 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m11:39:02.212813 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m11:39:02.217969 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m11:39:02.230059 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-22 11:39:02.213753 => 2024-08-22 11:39:02.229891
[0m11:39:02.231525 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m11:39:02.237615 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m11:39:02.250255 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:02.251528 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m11:39:02.252678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.280447 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:02.281931 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:02.283389 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m11:39:02.297517 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:02.301755 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:02.302965 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m11:39:02.307034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.311150 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m11:39:02.313065 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:02.314556 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m11:39:02.320446 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:02.325669 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:02.327456 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m11:39:02.331698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:02.333991 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-22 11:39:02.232733 => 2024-08-22 11:39:02.333933
[0m11:39:02.334866 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m11:39:02.337608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea97a6290>]}
[0m11:39:02.339548 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.13s]
[0m11:39:02.341998 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:39:02.344672 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:39:02.346640 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m11:39:02.348643 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:39:02.350159 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:39:02.354121 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:39:02.367120 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-22 11:39:02.351434 => 2024-08-22 11:39:02.366962
[0m11:39:02.368347 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:39:02.378859 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:39:02.398208 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.399854 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:39:02.401434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.431642 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:02.433121 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.434353 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:39:02.438060 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:02.444013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.444906 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m11:39:02.447370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.451477 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.452234 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m11:39:02.454699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.458973 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m11:39:02.460310 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.461267 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m11:39:02.466904 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:02.472505 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:02.474003 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m11:39:02.483743 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:02.486732 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-22 11:39:02.369517 => 2024-08-22 11:39:02.486659
[0m11:39:02.488165 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:39:02.490506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea97f61a0>]}
[0m11:39:02.492388 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.14s]
[0m11:39:02.494477 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:39:02.496269 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m11:39:02.497932 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m11:39:02.500204 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m11:39:02.502231 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m11:39:02.506500 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m11:39:02.528932 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-22 11:39:02.503813 => 2024-08-22 11:39:02.528756
[0m11:39:02.530801 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m11:39:02.543317 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m11:39:02.559175 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:02.560880 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m11:39:02.562245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.602128 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:02.603922 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:02.605363 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m11:39:02.612801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m11:39:02.619622 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:02.621068 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m11:39:02.627600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:02.633449 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m11:39:02.634825 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:02.636285 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m11:39:02.644048 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:02.648615 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:02.649580 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m11:39:02.652455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:02.655562 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-22 11:39:02.531933 => 2024-08-22 11:39:02.655451
[0m11:39:02.658393 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m11:39:02.660949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ae730a-9ec2-4354-a909-648517d354e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea97f5a20>]}
[0m11:39:02.662646 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.16s]
[0m11:39:02.664256 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m11:39:02.666919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:02.667878 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:02.668715 [debug] [MainThread]: On master: BEGIN
[0m11:39:02.669482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:02.689661 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:02.692173 [debug] [MainThread]: On master: COMMIT
[0m11:39:02.694051 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:02.696034 [debug] [MainThread]: On master: COMMIT
[0m11:39:02.699991 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:39:02.701084 [debug] [MainThread]: On master: Close
[0m11:39:02.702866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:02.704053 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m11:39:02.705042 [info ] [MainThread]: 
[0m11:39:02.707902 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m11:39:02.710428 [debug] [MainThread]: Command end result
[0m11:39:02.729258 [info ] [MainThread]: 
[0m11:39:02.730668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:02.732246 [info ] [MainThread]: 
[0m11:39:02.733857 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:39:02.735448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea9851960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea98f52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea98f6bc0>]}
[0m11:39:02.736658 [debug] [MainThread]: Flushing usage events
[0m11:39:02.765638 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2024-08-22 11:39:10.445720 | 2b4e3e8c-0a95-4a9a-8e8c-74c262b19999 ==============================
[0m11:39:10.445720 [info ] [MainThread]: Running with dbt=1.4.7
[0m11:39:10.448929 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:39:10.450964 [debug] [MainThread]: Tracking: tracking
[0m11:39:10.454550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b603d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b603d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b603d390>]}
[0m11:39:10.482769 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m11:39:10.696883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:10.698681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:10.711045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b478d1e0>]}
[0m11:39:10.740700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b46ce7a0>]}
[0m11:39:10.742354 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m11:39:10.743784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b46ce800>]}
[0m11:39:10.747509 [info ] [MainThread]: 
[0m11:39:10.751375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:10.754595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m11:39:10.767839 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m11:39:10.769921 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m11:39:10.772487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:10.802038 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m11:39:10.806102 [debug] [ThreadPool]: On list_destination_db: Close
[0m11:39:10.811391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m11:39:10.820902 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:39:10.822893 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m11:39:10.824394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:10.846309 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m11:39:10.847341 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m11:39:10.848187 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:39:10.854447 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m11:39:10.857830 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m11:39:10.860787 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m11:39:10.874467 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:10.875815 [debug] [MainThread]: On master: BEGIN
[0m11:39:10.876959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:10.904564 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:10.906478 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:10.908029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:10.919345 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m11:39:10.922476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b45c52d0>]}
[0m11:39:10.923993 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:10.926999 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:10.928340 [debug] [MainThread]: On master: BEGIN
[0m11:39:10.933685 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:10.935202 [debug] [MainThread]: On master: COMMIT
[0m11:39:10.937872 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:10.939743 [debug] [MainThread]: On master: COMMIT
[0m11:39:10.944031 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:39:10.945877 [debug] [MainThread]: On master: Close
[0m11:39:10.948299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:10.950040 [info ] [MainThread]: 
[0m11:39:10.973555 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m11:39:10.975049 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m11:39:10.977334 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m11:39:10.978816 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m11:39:10.984366 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m11:39:10.998548 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-22 11:39:10.980609 => 2024-08-22 11:39:10.998342
[0m11:39:11.000048 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m11:39:11.072026 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m11:39:11.088304 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.090239 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m11:39:11.091764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.117942 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:11.119766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.121677 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m11:39:11.127753 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:11.141302 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.142575 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m11:39:11.146836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.153014 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.156013 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m11:39:11.160872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.199983 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m11:39:11.202041 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.204090 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m11:39:11.210508 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:11.220129 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m11:39:11.222132 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m11:39:11.229221 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:11.232651 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-22 11:39:11.001489 => 2024-08-22 11:39:11.232564
[0m11:39:11.234252 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m11:39:11.236866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b4644df0>]}
[0m11:39:11.238934 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.26s]
[0m11:39:11.243429 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m11:39:11.245780 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m11:39:11.247463 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m11:39:11.249698 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m11:39:11.251005 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m11:39:11.258940 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m11:39:11.274320 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-22 11:39:11.252421 => 2024-08-22 11:39:11.274114
[0m11:39:11.275867 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m11:39:11.283987 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m11:39:11.299353 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.300955 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m11:39:11.302500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.329870 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:11.331561 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.333057 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m11:39:11.338869 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:11.345834 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.347723 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m11:39:11.352385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.357666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.359172 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m11:39:11.363071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.369684 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m11:39:11.371936 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.373507 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m11:39:11.380683 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:11.384976 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m11:39:11.387310 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m11:39:11.395334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:11.398289 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-22 11:39:11.277206 => 2024-08-22 11:39:11.398207
[0m11:39:11.399761 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m11:39:11.402390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b468a800>]}
[0m11:39:11.405373 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.15s]
[0m11:39:11.407165 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m11:39:11.408866 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m11:39:11.410375 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m11:39:11.412121 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m11:39:11.413732 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m11:39:11.419732 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m11:39:11.435111 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-22 11:39:11.414779 => 2024-08-22 11:39:11.434909
[0m11:39:11.438155 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m11:39:11.444880 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m11:39:11.459214 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.460724 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m11:39:11.462120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.489221 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:11.490826 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.492088 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m11:39:11.506137 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:11.510637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.511882 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m11:39:11.515750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.522566 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.523997 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m11:39:11.527230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.531482 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m11:39:11.532949 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.534203 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m11:39:11.540857 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:11.544923 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m11:39:11.546307 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m11:39:11.554426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:11.558514 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-22 11:39:11.439697 => 2024-08-22 11:39:11.558429
[0m11:39:11.560167 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m11:39:11.562683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b468b7f0>]}
[0m11:39:11.564730 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.15s]
[0m11:39:11.566639 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m11:39:11.568014 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m11:39:11.569796 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m11:39:11.573020 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m11:39:11.574581 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m11:39:11.579103 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m11:39:11.591287 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-22 11:39:11.575685 => 2024-08-22 11:39:11.591126
[0m11:39:11.592509 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m11:39:11.598212 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m11:39:11.615638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.616904 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m11:39:11.618046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.644424 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:11.645774 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.646677 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m11:39:11.650611 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m11:39:11.657084 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.658171 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m11:39:11.660920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.667272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.668312 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m11:39:11.672697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.676780 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m11:39:11.677929 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.678741 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m11:39:11.686430 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:11.690175 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m11:39:11.691522 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m11:39:11.698247 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:11.700950 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-22 11:39:11.593851 => 2024-08-22 11:39:11.700886
[0m11:39:11.702226 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m11:39:11.704769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b24b8f40>]}
[0m11:39:11.706518 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.13s]
[0m11:39:11.708574 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m11:39:11.710362 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m11:39:11.711863 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m11:39:11.714046 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m11:39:11.716134 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m11:39:11.719904 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m11:39:11.734038 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-22 11:39:11.717475 => 2024-08-22 11:39:11.733801
[0m11:39:11.735735 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m11:39:11.743285 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m11:39:11.758911 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.760365 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m11:39:11.761720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.788531 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m11:39:11.789836 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.791152 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m11:39:11.796821 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m11:39:11.804090 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.805603 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m11:39:11.809088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.813948 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.814982 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m11:39:11.818431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m11:39:11.822383 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m11:39:11.823525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.824764 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m11:39:11.833392 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m11:39:11.837767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m11:39:11.839302 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m11:39:11.847011 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m11:39:11.849850 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-22 11:39:11.737266 => 2024-08-22 11:39:11.849699
[0m11:39:11.851172 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m11:39:11.853683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4e3e8c-0a95-4a9a-8e8c-74c262b19999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b24aff70>]}
[0m11:39:11.856487 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.14s]
[0m11:39:11.858420 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m11:39:11.861712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:11.863082 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:11.864356 [debug] [MainThread]: On master: BEGIN
[0m11:39:11.865815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:11.894479 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m11:39:11.895972 [debug] [MainThread]: On master: COMMIT
[0m11:39:11.897264 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:11.898510 [debug] [MainThread]: On master: COMMIT
[0m11:39:11.901720 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m11:39:11.903294 [debug] [MainThread]: On master: Close
[0m11:39:11.905613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:11.907108 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m11:39:11.908892 [info ] [MainThread]: 
[0m11:39:11.910720 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m11:39:11.913069 [debug] [MainThread]: Command end result
[0m11:39:11.941555 [info ] [MainThread]: 
[0m11:39:11.943401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:11.945053 [info ] [MainThread]: 
[0m11:39:11.946697 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:39:11.948710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b4669ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b4647a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b4647940>]}
[0m11:39:11.950191 [debug] [MainThread]: Flushing usage events
[0m11:39:11.978199 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2024-08-24 09:56:04.777308 | 52a6f6fc-13c0-4251-8999-20cdd45b763b ==============================
[0m09:56:04.777308 [info ] [MainThread]: Running with dbt=1.4.7
[0m09:56:04.780900 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:56:04.781869 [debug] [MainThread]: Tracking: tracking
[0m09:56:04.792036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238cec90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238cec97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238cec9390>]}
[0m09:56:04.808488 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m09:56:05.073505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:56:05.074686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:56:05.084624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b619180>]}
[0m09:56:05.106792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b54a740>]}
[0m09:56:05.107759 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:56:05.108838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b54a7a0>]}
[0m09:56:05.111879 [info ] [MainThread]: 
[0m09:56:05.115557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:05.117752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m09:56:05.130985 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m09:56:05.132479 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m09:56:05.133508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:05.165792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m09:56:05.167717 [debug] [ThreadPool]: On list_destination_db: Close
[0m09:56:05.170251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m09:56:05.177171 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:56:05.178409 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m09:56:05.179767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:05.194702 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m09:56:05.195784 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:56:05.196701 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m09:56:05.201087 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m09:56:05.202768 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m09:56:05.204568 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m09:56:05.211544 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.212575 [debug] [MainThread]: On master: BEGIN
[0m09:56:05.213529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:05.227827 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:05.229018 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.230027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:05.235953 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m09:56:05.237508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b451270>]}
[0m09:56:05.238393 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:05.240294 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.241039 [debug] [MainThread]: On master: BEGIN
[0m09:56:05.243983 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:05.245034 [debug] [MainThread]: On master: COMMIT
[0m09:56:05.246063 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.246911 [debug] [MainThread]: On master: COMMIT
[0m09:56:05.248911 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:56:05.249812 [debug] [MainThread]: On master: Close
[0m09:56:05.251431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:56:05.252523 [info ] [MainThread]: 
[0m09:56:05.269978 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m09:56:05.270922 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m09:56:05.272239 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m09:56:05.273109 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m09:56:05.276626 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m09:56:05.285357 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-24 09:56:05.273768 => 2024-08-24 09:56:05.285205
[0m09:56:05.286395 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m09:56:05.332286 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m09:56:05.342688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.343623 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m09:56:05.344330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:05.359442 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:05.360502 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.361246 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m09:56:05.364659 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:05.371172 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.371954 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m09:56:05.373918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.377464 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.378699 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m09:56:05.381413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.405730 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:56:05.407211 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.408510 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:56:05.413612 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:05.419341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:05.420282 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m09:56:05.425129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:05.426991 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-24 09:56:05.287108 => 2024-08-24 09:56:05.426933
[0m09:56:05.427692 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m09:56:05.429224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b4cce20>]}
[0m09:56:05.430502 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m09:56:05.432969 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m09:56:05.433881 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m09:56:05.434716 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m09:56:05.435899 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m09:56:05.436706 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m09:56:05.439975 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m09:56:05.447828 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-24 09:56:05.437262 => 2024-08-24 09:56:05.447620
[0m09:56:05.448914 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m09:56:05.454009 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m09:56:05.462523 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.463691 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m09:56:05.464530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:05.481640 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:05.482546 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.483215 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m09:56:05.486392 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:05.489734 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.490424 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m09:56:05.492388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.495654 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.496736 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m09:56:05.498764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.502352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:56:05.503104 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.503669 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:56:05.507195 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:05.509869 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:05.510561 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m09:56:05.515222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:05.517107 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-24 09:56:05.449594 => 2024-08-24 09:56:05.517053
[0m09:56:05.517879 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m09:56:05.519129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b516260>]}
[0m09:56:05.520191 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.08s]
[0m09:56:05.521336 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m09:56:05.522292 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m09:56:05.523110 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m09:56:05.524492 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m09:56:05.525384 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m09:56:05.529421 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m09:56:05.537277 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-24 09:56:05.526060 => 2024-08-24 09:56:05.537130
[0m09:56:05.538256 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m09:56:05.543074 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m09:56:05.551761 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:05.552755 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m09:56:05.553552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:05.568371 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:05.569321 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:05.570032 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m09:56:05.578824 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:05.582300 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:05.583049 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m09:56:05.585078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.587262 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:56:05.587963 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:05.588587 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:56:05.592043 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:05.595683 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:05.596806 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m09:56:05.598930 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:05.600908 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-24 09:56:05.538993 => 2024-08-24 09:56:05.600850
[0m09:56:05.601677 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m09:56:05.602972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b516260>]}
[0m09:56:05.605808 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.08s]
[0m09:56:05.607058 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m09:56:05.608028 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m09:56:05.609292 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m09:56:05.610933 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m09:56:05.611886 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m09:56:05.615577 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m09:56:05.623391 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-24 09:56:05.612802 => 2024-08-24 09:56:05.623212
[0m09:56:05.624575 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m09:56:05.630347 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m09:56:05.638178 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.639180 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m09:56:05.640023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:05.655733 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:05.656639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.657371 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m09:56:05.660313 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:05.664291 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.665192 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m09:56:05.667232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.670461 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.671345 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m09:56:05.673759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.676615 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:56:05.677406 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.678013 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:56:05.682435 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:05.686760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:05.687747 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m09:56:05.692931 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:05.695098 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-24 09:56:05.625376 => 2024-08-24 09:56:05.695026
[0m09:56:05.696211 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m09:56:05.697935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23893461d0>]}
[0m09:56:05.699109 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m09:56:05.700403 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m09:56:05.701439 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m09:56:05.702316 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m09:56:05.703482 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m09:56:05.704390 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m09:56:05.706625 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m09:56:05.714169 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-24 09:56:05.705092 => 2024-08-24 09:56:05.714040
[0m09:56:05.715254 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m09:56:05.720306 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m09:56:05.728701 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:05.730161 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m09:56:05.731249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:05.747611 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:05.748620 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:05.749302 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m09:56:05.752527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m09:56:05.756033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:05.756765 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m09:56:05.758892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:05.761196 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m09:56:05.762112 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:05.763243 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m09:56:05.767298 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:05.770010 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:05.770719 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m09:56:05.772658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:05.774360 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-24 09:56:05.715914 => 2024-08-24 09:56:05.774307
[0m09:56:05.775058 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m09:56:05.776173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52a6f6fc-13c0-4251-8999-20cdd45b763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2389345a50>]}
[0m09:56:05.777186 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.07s]
[0m09:56:05.778377 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m09:56:05.781713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:05.782798 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.783542 [debug] [MainThread]: On master: BEGIN
[0m09:56:05.784112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:05.799429 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:05.800376 [debug] [MainThread]: On master: COMMIT
[0m09:56:05.801254 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:05.802072 [debug] [MainThread]: On master: COMMIT
[0m09:56:05.803968 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:56:05.804811 [debug] [MainThread]: On master: Close
[0m09:56:05.806009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:05.806728 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m09:56:05.807481 [info ] [MainThread]: 
[0m09:56:05.808429 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m09:56:05.809905 [debug] [MainThread]: Command end result
[0m09:56:05.823983 [info ] [MainThread]: 
[0m09:56:05.825768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:05.827022 [info ] [MainThread]: 
[0m09:56:05.828269 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:56:05.829957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b5c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b46d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238b46fcd0>]}
[0m09:56:05.831272 [debug] [MainThread]: Flushing usage events


============================== 2024-08-24 09:56:14.027432 | 7a72b6dc-6954-4754-be53-d253aafbfcc9 ==============================
[0m09:56:14.027432 [info ] [MainThread]: Running with dbt=1.4.7
[0m09:56:14.029853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:56:14.030681 [debug] [MainThread]: Tracking: tracking
[0m09:56:14.032749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1b4d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1b4d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1b4d3c0>]}
[0m09:56:14.049815 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m09:56:14.189805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:56:14.190504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:56:14.198001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc028d1b0>]}
[0m09:56:14.216388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc03c2770>]}
[0m09:56:14.217236 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m09:56:14.218183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc03c27d0>]}
[0m09:56:14.220601 [info ] [MainThread]: 
[0m09:56:14.223676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:14.225666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m09:56:14.237626 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m09:56:14.238572 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m09:56:14.239402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:14.255324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m09:56:14.257018 [debug] [ThreadPool]: On list_destination_db: Close
[0m09:56:14.259388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m09:56:14.266036 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:56:14.266828 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m09:56:14.267416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:14.281413 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m09:56:14.282292 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m09:56:14.282914 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m09:56:14.286580 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m09:56:14.288736 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m09:56:14.290676 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m09:56:14.297541 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.298320 [debug] [MainThread]: On master: BEGIN
[0m09:56:14.298963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:14.313387 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:14.314304 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.315231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:14.320895 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m09:56:14.322668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc02c52a0>]}
[0m09:56:14.323501 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:14.325584 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.326384 [debug] [MainThread]: On master: BEGIN
[0m09:56:14.329531 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:14.330466 [debug] [MainThread]: On master: COMMIT
[0m09:56:14.331208 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.331868 [debug] [MainThread]: On master: COMMIT
[0m09:56:14.334070 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:56:14.334974 [debug] [MainThread]: On master: Close
[0m09:56:14.336335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:56:14.337338 [info ] [MainThread]: 
[0m09:56:14.351074 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m09:56:14.352181 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m09:56:14.353595 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m09:56:14.354546 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m09:56:14.358051 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m09:56:14.365245 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-08-24 09:56:14.355357 => 2024-08-24 09:56:14.365087
[0m09:56:14.366257 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m09:56:14.410323 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m09:56:14.420345 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.421351 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m09:56:14.422210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:14.437659 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:14.438587 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.439296 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m09:56:14.442342 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:14.448785 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.449544 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m09:56:14.451702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.454695 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.455417 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m09:56:14.457667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.481512 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:56:14.482922 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.484016 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m09:56:14.487808 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:14.493028 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m09:56:14.493758 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m09:56:14.497957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:14.500127 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-08-24 09:56:14.367030 => 2024-08-24 09:56:14.500067
[0m09:56:14.500922 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m09:56:14.502311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc0148e20>]}
[0m09:56:14.503433 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.15s]
[0m09:56:14.506002 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m09:56:14.506888 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m09:56:14.507628 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m09:56:14.508842 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m09:56:14.509673 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m09:56:14.513105 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m09:56:14.520673 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-08-24 09:56:14.510246 => 2024-08-24 09:56:14.520501
[0m09:56:14.521610 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m09:56:14.526210 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m09:56:14.534355 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.535427 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m09:56:14.536353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:14.550789 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:14.551739 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.552464 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m09:56:14.555388 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:14.558736 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.559524 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m09:56:14.561626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.565085 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.565979 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m09:56:14.567952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.571429 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:56:14.572143 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.572724 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m09:56:14.576276 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:14.579231 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m09:56:14.580070 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m09:56:14.584429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:14.586425 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-08-24 09:56:14.522212 => 2024-08-24 09:56:14.586371
[0m09:56:14.587139 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m09:56:14.588237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc018e7d0>]}
[0m09:56:14.589394 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.08s]
[0m09:56:14.590466 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m09:56:14.591489 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m09:56:14.592287 [info ] [Thread-1 (]: 3 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m09:56:14.593498 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m09:56:14.594334 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m09:56:14.597902 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m09:56:14.605220 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-08-24 09:56:14.594965 => 2024-08-24 09:56:14.605058
[0m09:56:14.606650 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m09:56:14.612250 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m09:56:14.620143 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.621231 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m09:56:14.622256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:14.641033 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:14.642077 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.642900 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT 
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating::numeric >= 4.5 THEN 'Excellent'
            WHEN user_rating::numeric >= 4.0 THEN 'Good'
            WHEN user_rating::numeric >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM films
),


films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM films f 
    LEFT JOIN film_actors fa ON f.film_id = fa.film_id
    LEFT JOIN actors a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title  
)

SELECT 
    fwr.*,
    fwa.actors
FROM films_with_ratings fwr
JOIN films_with_actors fwa ON fwr.film_id = fwa.film_id


  );
  
[0m09:56:14.652053 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:14.655221 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.655946 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m09:56:14.658305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.661376 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.662237 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m09:56:14.664817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.667801 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:56:14.668568 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.669137 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m09:56:14.672836 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:14.676101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m09:56:14.676857 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m09:56:14.681937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:14.684234 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-08-24 09:56:14.607664 => 2024-08-24 09:56:14.684179
[0m09:56:14.685057 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m09:56:14.686296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc018f2e0>]}
[0m09:56:14.687322 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m09:56:14.688497 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m09:56:14.689547 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m09:56:14.690488 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films ...................................... [RUN]
[0m09:56:14.691697 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m09:56:14.692493 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m09:56:14.695657 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m09:56:14.704059 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-08-24 09:56:14.693057 => 2024-08-24 09:56:14.703932
[0m09:56:14.705032 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m09:56:14.709825 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m09:56:14.717294 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.718270 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m09:56:14.719512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:14.735808 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:14.736923 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.737916 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m09:56:14.741438 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m09:56:14.744896 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.746311 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m09:56:14.749583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.754240 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.755232 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m09:56:14.757705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.760082 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:56:14.760794 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.761450 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m09:56:14.765657 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:14.768434 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m09:56:14.769288 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m09:56:14.773378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:14.775527 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-08-24 09:56:14.705783 => 2024-08-24 09:56:14.775465
[0m09:56:14.776353 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m09:56:14.777755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc01dc070>]}
[0m09:56:14.779400 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m09:56:14.781199 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m09:56:14.782423 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m09:56:14.783333 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m09:56:14.784609 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m09:56:14.785591 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m09:56:14.787855 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m09:56:14.795384 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-08-24 09:56:14.786425 => 2024-08-24 09:56:14.795183
[0m09:56:14.796834 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m09:56:14.802208 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m09:56:14.808892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.809806 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m09:56:14.810736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:14.827587 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m09:56:14.828566 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.829587 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    SELECT * FROM films WHERE title = 'Inception'
  );
  
[0m09:56:14.833166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m09:56:14.836577 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.837371 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie" rename to "specific_movie__dbt_backup"
[0m09:56:14.839436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.842908 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.843740 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m09:56:14.846540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m09:56:14.849234 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m09:56:14.850059 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.850799 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m09:56:14.854209 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m09:56:14.857096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m09:56:14.858205 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m09:56:14.862565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m09:56:14.864734 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-08-24 09:56:14.797753 => 2024-08-24 09:56:14.864668
[0m09:56:14.865922 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m09:56:14.867243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a72b6dc-6954-4754-be53-d253aafbfcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc01dcf10>]}
[0m09:56:14.868231 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.08s]
[0m09:56:14.869404 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m09:56:14.871594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:14.872485 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.873206 [debug] [MainThread]: On master: BEGIN
[0m09:56:14.873903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:14.888529 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m09:56:14.889442 [debug] [MainThread]: On master: COMMIT
[0m09:56:14.890273 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:14.890986 [debug] [MainThread]: On master: COMMIT
[0m09:56:14.892945 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m09:56:14.893839 [debug] [MainThread]: On master: Close
[0m09:56:14.895051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:14.896139 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m09:56:14.896989 [info ] [MainThread]: 
[0m09:56:14.898077 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m09:56:14.899307 [debug] [MainThread]: Command end result
[0m09:56:14.913664 [info ] [MainThread]: 
[0m09:56:14.915092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:14.916229 [info ] [MainThread]: 
[0m09:56:14.917215 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:56:14.918592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc00fa050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc014ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc014b940>]}
[0m09:56:14.920409 [debug] [MainThread]: Flushing usage events
